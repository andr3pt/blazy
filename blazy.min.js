/*!
  hey, [be]Lazy.js - v1.2.2 - 2014.05.04 
  A lazy loading and multi-serving image script
  (c) Bjoern Klinggaard - @bklinggaard - http://dinbror.dk/blazy
*/
!function(e){"function"==typeof define&&define.amd?define(e):window.Blazy=e()}(function(){"use strict";function e(e){if(!document.querySelectorAll){var r=document.createStyleSheet();document.querySelectorAll=function(e,t,n,o,c){for(c=document.all,t=[],e=e.replace(/\[for\b/gi,"[htmlFor").split(","),n=e.length;n--;){for(r.addRule(e[n],"k:v"),o=c.length;o--;)c[o].currentStyle.k&&t.push(c[o]);r.removeRule(0)}return t}}y=!0,w=[],m=e||{},m.error=m.error||!1,m.offset=m.offset||100,m.success=m.success||!1,m.selector=m.selector||".b-lazy",m.separator=m.separator||"|",m.container=m.container?document.querySelectorAll(m.container):!1,m.errorClass=m.errorClass||"b-error",m.breakpoints=m.breakpoints||!1,m.successClass=m.successClass||"b-loaded",m.src=f=m.src||"data-src",g=window.devicePixelRatio>1,b=d(n,25),E=d(i,50),i(),u(m.breakpoints,function(e){var t=e.mode||"screen",n="viewport"==t?document.documentElement.clientWidth:window.screen.width;return e.width>=n?(f=e.src,!1):void 0}),t()}function t(){s(m.selector),y&&(y=!1,m.container&&u(m.container,function(e){a(e,"scroll",b)}),a(window,"resize",E),a(window,"resize",b),a(window,"scroll",b)),n()}function n(){for(var t=0;h>t;t++){var n=w[t];(o(n)||c(n))&&(e.prototype.load(n),w.splice(t,1),h--,t--)}0===h&&e.prototype.destroy()}function r(e){if(e.offsetWidth>0&&e.offsetHeight>0){var t=e.getAttribute(f)||e.getAttribute(m.src);if(t){var n=t.split(m.separator),r=n[g&&n.length>1?1:0],o=new Image;u(m.breakpoints,function(t){e.removeAttribute(t.src)}),e.removeAttribute(m.src),o.onerror=function(){m.error&&m.error(e,"invalid"),e.className=e.className+" "+m.errorClass},o.onload=function(){"img"===e.nodeName.toLowerCase()?e.src=r:e.style.backgroundImage='url("'+r+'")',e.className=e.className+" "+m.successClass,m.success&&m.success(e)},o.src=r}else m.error&&m.error(e,"missing"),e.className=e.className+" "+m.errorClass}}function o(e){var t=e.getBoundingClientRect(),n=p+m.offset;return t.left>=0&&t.right<=v+m.offset&&(t.top>=0&&t.top<=n||t.bottom<=n&&t.bottom>=0-m.offset)}function c(e){return-1!==(" "+e.className+" ").indexOf(" "+m.successClass+" ")}function s(e){var t=document.querySelectorAll(e);h=t.length;for(var n=h;n--;w.unshift(t[n]));}function i(){p=window.innerHeight||document.documentElement.clientHeight,v=window.innerWidth||document.documentElement.clientWidth}function a(e,t,n){e.attachEvent?e.attachEvent&&e.attachEvent("on"+t,n):e.addEventListener(t,n,!1)}function l(e,t,n){e.detachEvent?e.detachEvent&&e.detachEvent("on"+t,n):e.removeEventListener(t,n,!1)}function u(e,t){if(e&&t)for(var n=e.length,r=0;n>r&&t(e[r],r)!==!1;r++);}function d(e,t){var n=0;return function(){var r=+new Date;t>r-n||(n=r,e.apply(w,arguments))}}var f,m,v,p,w,h,g,y,b,E;return e.prototype.revalidate=function(){t()},e.prototype.load=function(e){c(e)||r(e)},e.prototype.destroy=function(){m.container&&u(m.container,function(e){l(e,"scroll",b)}),l(window,"scroll",b),l(window,"resize",b),l(window,"resize",E),h=0,w.length=0,y=!0},e});